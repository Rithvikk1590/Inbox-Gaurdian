<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Inbox Guardian</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/static/css/style.css" />
</head>

<body>
  <!-- Navbar -->
  <header class="topbar" style="position: sticky; top: 0; z-index: 1050;">
    <nav class="navbar navbar-expand-md navbar-dark bg-dark border-bottom">
      <div class="container">
        <!-- Brand -->
        <a class="navbar-brand d-flex align-items-center" href="#">
          <span class="bg-success text-dark fw-bold rounded-3 px-2 py-1 me-2">IG</span>
          <span class="fw-semibold">Inbox Guardian</span>
        </a>

        <!-- Hamburger -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#igNavbar"
          aria-controls="igNavbar" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Left-aligned nav items -->
        <div class="collapse navbar-collapse" id="igNavbar">
          <ul class="navbar-nav ms-3">
            <li class="nav-item"><a class="nav-link active" aria-current="page" href="#">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="/guide">Guide</a></li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <!-- Heading -->
  <section class="hero text-center my-4">
    <h1>Inbox Guardian</h1>
    <p>Upload your .eml files to examine if the email is a phishing email. Refer to /guide for more information!</p>
  </section>

  <!-- Tabs -->
  <nav class="tabs d-flex justify-content-center gap-3">
    <div class="tab" data-tab="eml" aria-selected="true">Upload .eml</div>
    <div class="tab" data-tab="csv">Upload .csv</div>
    <div class="tab" data-tab="manual">Manual Upload</div>
  </nav>

  <!-- Panels -->
  <main class="panel container my-4">
    <!-- EML Upload -->
    <div class="card tab-panel" id="eml-panel">
      <form action="/upload_eml" method="post" enctype="multipart/form-data" id="eml-form">
        <div class="drop-zone" id="drop-eml">
          <p>Drag &amp; Drop your .eml file here or click to upload</p>
          <input type="file" accept=".eml" name="eml_file" hidden />
        </div>
      </form>
    </div>

    <!-- CSV Upload -->
    <div class="card tab-panel hidden" id="csv-panel">
      <div class="drop-zone" id="drop-csv">
        <p>Drag &amp; Drop your .csv file here or click to upload</p>
        <input type="file" accept=".csv" hidden />
      </div>
    </div>

    <!-- Manual -->
    <div class="card tab-panel hidden" id="manual-panel">
      <textarea class="form-control" placeholder="Paste email text here..."></textarea>
      <button class="btn btn-primary mt-3">Analyze</button>
    </div>
  </main>

  <!-- Email Viewer Section (only shows when email is uploaded) -->
  {% if email %}
  <section class="container my-4" style="z-index: 1; position: relative;">
    <div class="card bg-dark border-success">
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-dark table-borderless mb-0">
            <tbody>
              <tr>
                <td class="fw-bold text-success" style="width: 150px;">Subject:</td>
                <td class="text-light">{{ email.subject }}</td>
              </tr>
              <tr>
                <td class="fw-bold text-success">To:</td>
                <td class="text-light">({{ email.to }})</td>
              </tr>
              <tr>
                <td class="fw-bold text-success">From Address:</td>
                <td class="text-light">{{ email.from }}</td>
              </tr>
              <tr>
                <td class="fw-bold text-success">Date:</td>
                <td class="text-light">{{ email.date }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div class="mt-4">
          <div class="border border-success rounded p-3" style="max-height: 400px; overflow-y: auto; background-color: #1a1a1a;">
            <pre class="text-light mb-0" style="font-size: 0.9rem; white-space: pre-wrap;">{{ email.body }}</pre>
          </div>
        </div>
        
        <div class="d-flex justify-content-between align-items-center mt-3 pt-3 border-top border-success">
          <!-- <div class="d-flex gap-2 align-items-center">
            <a href="#" class="text-success text-decoration-none">Unsubscribe</a>
            <span class="text-muted">|</span>
            <a href="#" class="text-success text-decoration-none">Update your profile</a>
            <span class="text-muted">| 113 Cherry St #92768, Seattle, WA 98104-2205</span>
          </div> -->
          <div class="text-muted small">
            Built with <strong>Kit</strong>
          </div>
        </div>
      </div>
    </div>
  </section>
  {% endif %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
  <script defer src="/static/js/script.js"></script>
</body>

</html>